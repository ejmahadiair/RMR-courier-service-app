{"ast":null,"code":"import _asyncToGenerator from\"E:/My-MERN-full-stack/RMR/RMR-courier-service-app/server/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"E:/My-MERN-full-stack/RMR/RMR-courier-service-app/server/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"E:\\\\My-MERN-full-stack\\\\RMR\\\\RMR-courier-service-app\\\\server\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useState,useEffect}from\"react\";import Editorder from\"../editorder/Editorder\";import Edittrack from\"../edittrackplace/Edittrack\";import\"./order.scss\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Order=function Order(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),orderdetail=_useState2[0],setOrderdetail=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),myorder=_useState4[0],setMyorder=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),editid=_useState6[0],setEditid=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),userstatus=_useState8[0],setUserstatus=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),track=_useState10[0],setTrack=_useState10[1];var getuserbyid=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"http://localhost:5000/api/user/id\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({id:localStorage.getItem(\"userId\")})});case 2:res=_context.sent;_context.next=5;return res.json();case 5:data=_context.sent;console.log(\"order user: \",data.user);setUserstatus(data.user.status);case 8:case\"end\":return _context.stop();}}},_callee);}));return function getuserbyid(){return _ref.apply(this,arguments);};}();useEffect(function(){getuserbyid();},[]);var getorderdetail=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetch(\"http://localhost:5000/api/order/\",{method:\"GET\",headers:{\"Content-Type\":\"application/json\"}});case 2:res=_context2.sent;_context2.next=5;return res.json();case 5:data=_context2.sent;// console.log(\"order Data: \", data);\nsetOrderdetail(data.orders);case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function getorderdetail(){return _ref2.apply(this,arguments);};}();useEffect(function(){getorderdetail();},[]);//delete spacific orders\nvar Deleteorder=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id){var res,data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return fetch(\"http://localhost:5000/api/order/\".concat(id),{method:\"DELETE\",headers:{\"Content-Type\":\"application/json\"}});case 2:res=_context3.sent;_context3.next=5;return res.json();case 5:data=_context3.sent;// console.log(\"area deleted order: \", data);\nalert(data.message);case 7:case\"end\":return _context3.stop();}}},_callee3);}));return function Deleteorder(_x){return _ref3.apply(this,arguments);};}();var deleteorder=function deleteorder(id){Deleteorder(id);};//aprove orders\nvar Aproveorder=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(id,status){var res,data;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return fetch(\"http://localhost:5000/api/order/aprove/\".concat(id),{method:\"PUT\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({status:status})});case 2:res=_context4.sent;_context4.next=5;return res.json();case 5:data=_context4.sent;// console.log(\"aprove order: \", data);\nif(data.order.status===\"process\"){}case 7:case\"end\":return _context4.stop();}}},_callee4);}));return function Aproveorder(_x2,_x3){return _ref4.apply(this,arguments);};}();var aproveorder=function aproveorder(id){if(userstatus===\"admin\"){Aproveorder(id,\"process\");alert(\"Order on process\");}else{Aproveorder(id,\"ongoing\");alert(\"Order on going\");}};var editorder=function editorder(id){setMyorder(true);setEditid(id);};var edittrack=function edittrack(id){setTrack(true);setEditid(id);};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"order-container\",children:[!myorder&&!track&&/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:orderdetail.map(function(item,key){return/*#__PURE__*/_jsxs(\"div\",{className:\"col-lg-4 item\",children:[/*#__PURE__*/_jsx(\"h2\",{children:item.type}),/*#__PURE__*/_jsx(\"h3\",{children:item.status}),/*#__PURE__*/_jsxs(\"h4\",{children:[\"Place: \",item.city,\" City\"]}),/*#__PURE__*/_jsxs(\"h5\",{children:[\"Area: \",item.area]}),/*#__PURE__*/_jsxs(\"h6\",{children:[\"Order id: \",item._id]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Details Area : \",item.darea]}),/*#__PURE__*/_jsxs(\"h6\",{children:[\"Paid: $\",item.charge,\" BDD\"]}),userstatus===\"admin\"&&/*#__PURE__*/_jsxs(\"div\",{className:\"parmission\",children:[item.status===\"panding\"&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:function onClick(){return aproveorder(item._id);},children:\"Aprove\"}),item.status===\"process\"&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:function onClick(){return editorder(item._id);},children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"reject\",onClick:function onClick(){return deleteorder(item._id);},children:\"Delete\"})]}),userstatus===\"dman\"&&/*#__PURE__*/_jsxs(\"div\",{className:\"parmission\",children:[item.status===\"process\"&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:function onClick(){return aproveorder(item._id);},children:\"Receve\"}),item.status===\"ongoing\"&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:function onClick(){return edittrack(item._id);},children:\"Ensure current location\"})]})]},key);})}),myorder&&/*#__PURE__*/_jsx(Editorder,{setMyorder:setMyorder,editid:editid}),track&&/*#__PURE__*/_jsx(Edittrack,{setTrack:setTrack,editid:editid})]})});};export default Order;","map":{"version":3,"sources":["E:/My-MERN-full-stack/RMR/RMR-courier-service-app/server/client/src/components/profilecontrol/order/Order.js"],"names":["React","useState","useEffect","Editorder","Edittrack","Order","orderdetail","setOrderdetail","myorder","setMyorder","editid","setEditid","userstatus","setUserstatus","track","setTrack","getuserbyid","fetch","method","headers","body","JSON","stringify","id","localStorage","getItem","res","json","data","console","log","user","status","getorderdetail","orders","Deleteorder","alert","message","deleteorder","Aproveorder","order","aproveorder","editorder","edittrack","map","item","key","type","city","area","_id","darea","charge"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport Editorder from \"../editorder/Editorder\";\r\nimport Edittrack from \"../edittrackplace/Edittrack\";\r\nimport \"./order.scss\";\r\nconst Order = () => {\r\n  const [orderdetail, setOrderdetail] = useState([]);\r\n  const [myorder, setMyorder] = useState(false);\r\n  const [editid, setEditid] = useState(\"\");\r\n  const [userstatus, setUserstatus] = useState(\"\");\r\n  const [track, setTrack] = useState(false);\r\n\r\n  const getuserbyid = async () => {\r\n    const res = await fetch(\"http://localhost:5000/api/user/id\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        id: localStorage.getItem(\"userId\"),\r\n      }),\r\n    });\r\n    const data = await res.json();\r\n    console.log(\"order user: \", data.user);\r\n    setUserstatus(data.user.status);\r\n  };\r\n  useEffect(() => {\r\n    getuserbyid();\r\n  }, []);\r\n\r\n  const getorderdetail = async () => {\r\n    const res = await fetch(\"http://localhost:5000/api/order/\", {\r\n      method: \"GET\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n    });\r\n    const data = await res.json();\r\n    // console.log(\"order Data: \", data);\r\n    setOrderdetail(data.orders);\r\n  };\r\n\r\n  useEffect(() => {\r\n    getorderdetail();\r\n  }, []);\r\n  //delete spacific orders\r\n  const Deleteorder = async (id) => {\r\n    const res = await fetch(`http://localhost:5000/api/order/${id}`, {\r\n      method: \"DELETE\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n    });\r\n    const data = await res.json();\r\n    // console.log(\"area deleted order: \", data);\r\n    alert(data.message);\r\n  };\r\n  const deleteorder = (id) => {\r\n    Deleteorder(id);\r\n  };\r\n  //aprove orders\r\n  const Aproveorder = async (id, status) => {\r\n    const res = await fetch(`http://localhost:5000/api/order/aprove/${id}`, {\r\n      method: \"PUT\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        status: status,\r\n      }),\r\n    });\r\n    const data = await res.json();\r\n    // console.log(\"aprove order: \", data);\r\n    if (data.order.status === \"process\") {\r\n    }\r\n  };\r\n  const aproveorder = (id) => {\r\n    if (userstatus === \"admin\") {\r\n      Aproveorder(id, \"process\");\r\n      alert(\"Order on process\");\r\n    } else {\r\n      Aproveorder(id, \"ongoing\");\r\n      alert(\"Order on going\");\r\n    }\r\n  };\r\n\r\n  const editorder = (id) => {\r\n    setMyorder(true);\r\n    setEditid(id);\r\n  };\r\n  const edittrack = (id) => {\r\n    setTrack(true);\r\n    setEditid(id);\r\n  };\r\n  return (\r\n    <>\r\n      <div className=\"order-container\">\r\n        {!myorder && !track && (\r\n          <div className=\"row\">\r\n            {/*start*/}\r\n            {orderdetail.map((item, key) => {\r\n              return (\r\n                <div className=\"col-lg-4 item\" key={key}>\r\n                  <h2>{item.type}</h2>\r\n                  <h3>{item.status}</h3>\r\n                  <h4>Place: {item.city} City</h4>\r\n                  <h5>Area: {item.area}</h5>\r\n                  <h6>Order id: {item._id}</h6>\r\n                  <p>Details Area : {item.darea}</p>\r\n                  <h6>Paid: ${item.charge} BDD</h6>\r\n                  {userstatus === \"admin\" && (\r\n                    <div className=\"parmission\">\r\n                      {item.status === \"panding\" && (\r\n                        <button\r\n                          type=\"button\"\r\n                          onClick={() => aproveorder(item._id)}\r\n                        >\r\n                          Aprove\r\n                        </button>\r\n                      )}\r\n                      {item.status === \"process\" && (\r\n                        <button\r\n                          type=\"button\"\r\n                          onClick={() => editorder(item._id)}\r\n                        >\r\n                          Edit\r\n                        </button>\r\n                      )}\r\n\r\n                      <button\r\n                        type=\"button\"\r\n                        className=\"reject\"\r\n                        onClick={() => deleteorder(item._id)}\r\n                      >\r\n                        Delete\r\n                      </button>\r\n                    </div>\r\n                  )}\r\n                  {userstatus === \"dman\" && (\r\n                    <div className=\"parmission\">\r\n                      {item.status === \"process\" && (\r\n                        <button\r\n                          type=\"button\"\r\n                          onClick={() => aproveorder(item._id)}\r\n                        >\r\n                          Receve\r\n                        </button>\r\n                      )}\r\n                      {item.status === \"ongoing\" && (\r\n                        <button\r\n                          type=\"button\"\r\n                          onClick={() => edittrack(item._id)}\r\n                        >\r\n                          Ensure current location\r\n                        </button>\r\n                      )}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              );\r\n            })}\r\n            {/*end*/}\r\n          </div>\r\n        )}\r\n        {myorder && <Editorder setMyorder={setMyorder} editid={editid} />}\r\n        {track && <Edittrack setTrack={setTrack} editid={editid} />}\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Order;\r\n"]},"metadata":{},"sourceType":"module"}